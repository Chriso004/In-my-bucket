<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.group7.inmybucket.dao.GroupMemberDAO">
	<insert id="addGroupMember">
		INSERT INTO GROUP_MEMBER_LIST(userid, group_no)
		VALUES (#{ param1 }, #{ param2 })
	</insert>

	<select id="getMembers"
		resultType="com.group7.inmybucket.dto.UserDTO">
		SELECT * FROM USERTABLE WHERE userid IN (SELECT userid FROM
		GROUP_MEMBER_LIST WHERE group_no = #{ param1 })
	</select>

	<select id="getQueueMembers" resultType="com.group7.inmybucket.dto.UserDTO">
		SELECT u.userid,
		u.usernick
		FROM GROUP_QUEUE q
		INNER JOIN USERTABLE u
		ON (q.userid = u.userid)
		WHERE group_no = #{ param1 }
	</select>

	<select id="getMemberCount" resultType="int">
		SELECT count(*) FROM
		GROUP_MEMBER_LIST WHERE group_no
		= #{ param1 }
	</select>

	<delete id="deleteGroupMember">
		DELETE FROM GROUP_MEMBER_LIST WHERE userid = #{
		param1 } AND group_no = #{ param2 }
	</delete>

	<select id="isMember" resultType="boolean">
		SELECT count(*) FROM GROUP_MEMBER_LIST WHERE userid =
		#{ param1 } AND group_no = #{ param2 }
	</select>

	<select id="inQueue" resultType="boolean">
		SELECT count(*) FROM GROUP_QUEUE WHERE userid = #{
		param1 } AND group_no = #{ param2 }
	</select>

	<delete id="deleteInQueue">
		DELETE FROM GROUP_QUEUE WHERE userid = #{ param1 } AND
		group_no = #{ param2 }
	</delete>
</mapper>